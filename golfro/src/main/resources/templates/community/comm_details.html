
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ê²Œì‹œë¬¼ ìƒì„¸ë³´ê¸°</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
	rel="stylesheet">
<link rel="stylesheet" href="/css/header.css" />
<link rel="stylesheet" href="/css/footer.css" />
<link rel="stylesheet" href="/css/comm_details.css" />

<link rel="stylesheet" type="text/css" th:href="@{/css/header.css}">
</head>


<body>
	<header th:replace="~{fragments/header :: header}"></header>

	<main>
		<div
			class="d-flex flex-column justify-content-center align-items-center p-3 mb-5">
			<div class="container-fluid" th:object=${post}>

				<div class="top-ad-banner">
					<img th:src="@{/images/ad-2.png}" alt="ì´ë²¤íŠ¸ë¥¼ ë¶€íƒí•´ ê´‘ê³  ë°°ë„ˆ">
				</div>
				<div class="comm-post">

					<div class="comm-left p-3">
						<span class="community_title">ì»¤ë®¤ë‹ˆí‹°</span>
						<div class="createBtn px-2">
							<th:block th:if="${session.signedInUser != null}">
								<!-- signedInUserê°€ ìˆëŠ” ê²½ìš°: ê¸€ì“°ê¸° ë§í¬ -->
								<a th:href="@{/community/comm_create}" class="form-control btn"><i
									class="bi bi-pencil-fill"></i> ê¸€ì“°ê¸°</a>
							</th:block>
							<th:block th:unless="${session.signedInUser != null}">
								<!-- signedInUserê°€ ì—†ëŠ” ê²½ìš°: ë¡œê·¸ì¸ ë§í¬ -->
								<a th:href="@{/user/signin}" class="form-control btn">ë¡œê·¸ì¸</a>
							</th:block>
						</div>

						<a th:href="@{/community/comm_main}" class="all-post-btn px-2">
							<i class="bi bi-list"> </i>ì „ì²´ ê²Œì‹œê¸€
						</a>
						<div class="cate-post-btn px-2">ì¹´í…Œê³ ë¦¬</div>
						<a
							th:href="@{http://localhost:8080/community/comm_main?post-cate=F001&search-category=t&keyword=}"
							class="cate-post-btn px-2"> <i class="bi bi-dot"></i> ì¡ë‹´
						</a><a
							th:href="@{http://localhost:8080/community/comm_main?post-cate=F002&search-category=t&keyword=}"
							class="cate-post-btn px-2"> <i class="bi bi-dot"></i> íŒ/ë…¸í•˜ìš°
						</a><a
							th:href="@{http://localhost:8080/community/comm_main?post-cate=F003&search-category=t&keyword=}"
							class="cate-post-btn px-2"> <i class="bi bi-dot"></i> ë¼ìš´ë“œ í›„ê¸°
						</a>
					</div>
					<div class="comm-middle ">
						<!-- ì´ì „ê¸€, ë‹¤ìŒê¸€, ëª©ë¡ë³´ê¸° ë²„íŠ¼ ì˜ì—­ -->
						<div class="pre-next d-flex justify-content-end mb-3">
							<a
								th:href="${previousPost == null ? '#' : '/community/details/' + previousPost.id}"
								class="btn btn-outline-secondary"
								th:classappend="${previousPost == null ? 'disabled' : ''}">
								<i class="bi bi-chevron-up"></i> ì´ì „ê¸€
							</a> <a
								th:href="${nextPost == null ? '#' : '/community/details/' + nextPost.id}"
								class="btn btn-outline-secondary"
								th:classappend="${nextPost == null ? 'disabled' : ''}"> ë‹¤ìŒê¸€
								<i class="bi bi-chevron-down"></i>
							</a>
						</div>




						<div class="card">
							<div class="card-header">
								<small class="card-category" th:text="*{category.name}"></small>
								<input type="hidden" id="postId" th:value="*{id}" />
								<h3 class="card-title" th:text="*{title}"></h3>
								<span><i class="bi bi-person" th:text="*{user.nickname}"></i></span></br>
								<div class="d-flex justify-content-between">
									<div class="title-info mt-2">
										<i class="bi bi-clock"></i> <small class="text-black"
											th:text="*{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}"></small>
										<span><i class="bi bi-eye" th:text="*{views}"></i></span> <span><i
											class="bi bi-hand-thumbs-up" th:text="*{likes}"></i> <span
											id="likesCount"></span></span> <span><i
											class="bi bi-chat-dots" th:text="${commentcount}"></i></span>

									</div>
									<div class="d-flex align-items-center">
										<div class="url-copy-container">
											<span id="copyMessage" class="text-success"
												style="display: none;">ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</span>
											<button id="btnCopyUrl" class="btn btn-custom">
												<i class="bi bi-share"></i>
											</button>
										</div>
										<script>
											document
													.getElementById(
															'btnCopyUrl')
													.addEventListener(
															'click',
															function() {
																const currentUrl = window.location.href;
																navigator.clipboard
																		.writeText(
																				currentUrl)
																		.then(
																				function() {
																					const message = document
																							.getElementById('copyMessage');
																					message.style.display = 'inline';
																					setTimeout(
																							function() {
																								message.style.display = 'none';
																							},
																							2000);
																				},
																				function(
																						err) {
																					console
																							.error(
																									'URL ë³µì‚¬ ì‹¤íŒ¨: ',
																									err);
																				});
															});
										</script>

										<!-- Dropdown button next to the share button -->
										<div th:if="${session.signedInUser != null}"
											class="dropdown ms-2">
											<i class="bi bi-three-dots" id="dropdownMenuButton"
												data-bs-toggle="dropdown" aria-expanded="false"
												style="cursor: pointer;"></i>
											<ul
												class="dropdown-menu dropdown-menu-end custom-dropdown-menu"
												aria-labelledby="dropdownMenuButton">
												<th:block
													th:if="${session.signedInUser == post.user.userid or session.signedInUser == 'admin'}">
													<form th:action="@{/community/comm_modify/{id}(id=*{id})}"
														method="get" style="display: inline;">
														<button type="submit" id="modifyDelete"
															class="btn btn-custom ms-2">ìˆ˜ì •í•˜ê¸°</button>
													</form>
													<button id="btnDelete" class="btn btn-custom ms-2">ì‚­ì œí•˜ê¸°</button>
												</th:block>
											</ul>
										</div>
									</div>
								</div>
							</div>

							<div class="card-body">
								<div class="post-info d-flex justify-content-between mb-3">


								</div>
								<div class="post-content">
									<th:block th:ift="*{media != null}">
										<div class="image-container">
											<img alt="" th:src="@{${post.media}}"
												class="img-fluid max-size">
										</div>
									</th:block>
									<div th:text="*{content}"></div>
								</div>

								<!-- ê²Œì‹œê¸€ ì¢‹ì•„ìš” ë²„íŠ¼ ì˜ì—­(ì´ê±¸ ì™œ ë¡œê·¸ì¸ ì„¸ì…˜ì— ëŒ€í•œ ì¡°ê±´ë¶€ ê±¸ì–´ë†¨ëŠ”ì§€ ì´í•´ê°€ 1ë„ ì•ˆ ë¨) -->
								<div class="position-relative mb-4 text-end">
									<th:block th:if="${session.signedInUser eq {post.user.userid}}">
										<!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ìˆì„ ë•Œì˜ ë²„íŠ¼ -->
										<button id="btnLikes" class="btn btn-like btn-lg btn-custom">
											<i class="bi bi-hand-thumbs-up-fill"> ì¶”ì²œí•˜ê¸°</i>
										</button>
									</th:block>
									<th:block th:if="${session.signedInUser != {post.user.userid}}">
										<!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ì—†ì„ ë•Œì˜ ì²˜ë¦¬ -->
										<button id="btnLikes-notloggedIn"
											class="btn btn-like btn-lg btn-custom">
											<i class="bi bi-hand-thumbs-up-fill"> ì¶”ì²œí•˜ê¸°</i>
										</button>
									</th:block>
								</div>

								<!-- ê²Œì‹œê¸€ ì‚­ì œ/ìˆ˜ì •í•˜ê¸° ì˜ì—­ 
								<div class="d-flex justify-content-end mt-2">
									<th:block
										th:if="${session.signedInUser == post.user.userid or session.signedInUser == 'admin'}">
										<form th:action="@{/community/comm_modify/{id}(id=*{id})}"
											method="get" style="display: inline;">
											<button type="submit"
												class="btn btn-outline-primary btn-custom ms-2">âœï¸ìˆ˜ì •</button>
										</form>
										<button id="btnDelete"
											class="btn btn-outline-danger btn-custom ms-2">ğŸ—‘ï¸ì‚­ì œ</button>
									</th:block>
								</div> -->







								<!-- ëŒ“ê¸€ ì‘ì„± ì˜ì—­ -->

								<th:block th:if="${session.signedInUser != null}">
									<form class="comment-form">
										<div class="text-left">
											<span><i class="bi bi-chat-dots"></i> ëŒ“ê¸€ ëª©ë¡</span> <span>|
												<span th:text="${commentcount}"></span>ê°œì˜ ë‹µë³€
											</span>
										</div>
										<div class="input-group row mt-2">
											<input name="author" id="author" type="hidden"
												class="form-control" th:value="${session.signedInUserId}">

											<div class="content-area justify-content-center col-12">
												<div class="content-input">
													<textarea name="content" id="content" class="form-control"
														rows="3" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
												</div>
												<div class="submit-btn">
													<input type="hidden" name="postId" th:value="*{id}">
													<button id="btnRegisterComment"
														class="btn btn-register-comment" type="submit">ë“±ë¡</button>
												</div>
											</div>
										</div>
									</form>
								</th:block>




								<!-- í¬ì»¤ì‹±í•  ëŒ“ê¸€ id -->
								<input type="hidden" id="commentId" value="${commentId}" />
								<div class="comment-list row">
									<th:block th:each="commentlist:${commentlist}"
										th:object="${commentlist}">
										<div class="comment col-12"
											th:id="|comment-${commentlist.id}|">
											<!-- ëŒ“ê¸€ ì‘ì„±ì, ë‚´ìš©ì˜ì—­ -->
											<b th:text="${commentlist.user.nickname}"></b>
											<div class="mainComment">
												<p th:text="*{content}"></p>
												<div
													class="d-flex justify-content-between align-items-center">
													<small class="text-muted"
														th:text="*{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}"></small>
													<input type="hidden" name="commentId"
														th:value="${commentlist.id}">

													<!-- ëŒ“ê¸€ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ ì˜ì—­ -->
													<div>
														<th:block
															th:if="${commentlist.user.userid == session.signedInUser or session.signedInUser == 'admin'}">
															<button id="btnUpdateComment"
																class="btn btn-register-comment" type="submit">ìˆ˜ì •</button>
															<input type="hidden" name="commentId"
																th:value="${commentlist.id}">
															<input type="hidden" id="userid"
																th:value="${commentlist.user.id}">
															<button id="btnDeleteComment"
																class="btn btn-register-comment" type="submit">ì‚­ì œ</button>
														</th:block>
													</div>
												</div>
											</div>
										</div>
									</th:block>
								</div>
							</div>
						</div>
					</div>
					<div class="comm-right">

						<div class="best-posts">BEST ì‹¤ì‹œê°„ ì¸ê¸°ê¸€</div>

						<!-- ì²« ë²ˆì§¸ í…Œì´ë¸” (ì¡ë‹´) -->
						<div class="table-container">
							<table class="table">
								<thead>
									<th class="text-center mt-2" colspan="3">ì¡ë‹´</th>
								</thead>
								<tbody>
									<th:block th:each="F001 : ${top5ByF001}">
										<tr class="table">
											<td class="left-align-bold"><a
												th:href="@{{id}(id=${F001.id})}" class="custom-link"
												th:text="${F001.title}"></a></td>

											<td><i class="bi bi-hand-thumbs-up"
												th:text="| ${F001.likes}|"></i></td>
										</tr>
									</th:block>
								</tbody>
							</table>
						</div>

						<!-- ë‘ ë²ˆì§¸ í…Œì´ë¸” (íŒ/ë…¸í•˜ìš°) -->
						<div class="table-container">
							<table class="table">
								<thead>
									<tr>
										<th class="text-center mt-2" colspan="3">íŒ/ë…¸í•˜ìš°</th>
									</tr>
								</thead>
								<tbody>
									<th:block th:each="F002 : ${top5ByF002}">
										<tr class="table">
											<td class="left-align-bold"><a
												th:href="@{{id}(id=${F002.id})}" class="custom-link"
												th:text="${F002.title}"></a></td>

											<td><i class="bi bi-hand-thumbs-up"
												th:text="| ${F002.likes}| + '&nbsp;&nbsp;&nbsp;'"></i></td>
										</tr>
									</th:block>
								</tbody>
							</table>
						</div>





					</div>
				</div>
			</div>
		</div>
	</main>
	<footer th:replace="~{fragments/footer :: footer}"></footer>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

	<script th:src="@{/js/comm_details.js}"></script>
</body>
</html>