
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Í≤åÏãúÎ¨º ÏÉÅÏÑ∏Î≥¥Í∏∞</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
	rel="stylesheet">
<link rel="stylesheet" href="/css/header.css" />
<link rel="stylesheet" href="/css/footer.css" />
<link rel="stylesheet" href="/css/comm_details.css" />

<link rel="stylesheet" type="text/css" th:href="@{/css/header.css}">
</head>


<body>
	<header th:replace="~{fragments/header :: header}"></header>

	<main>
		<div
			class="d-flex flex-column justify-content-center align-items-center">
			<div class="container-fluid" th:object=${post}>

				<div class="top-ad-banner">
					<img th:src="@{/images/ad-2.png}" alt="Ïù¥Î≤§Ìä∏Î•º Î∂ÄÌÉÅÌï¥ Í¥ëÍ≥† Î∞∞ÎÑà">
				</div>
				<div class="comm-post">

					<div class="comm-left p-3">
						<span class="community_title">Ïª§ÎÆ§ÎãàÌã∞</span>
						<div class="createBtn px-2">
							<th:block th:if="${session.signedInUser != null}">
								<!-- signedInUserÍ∞Ä ÏûàÎäî Í≤ΩÏö∞: Í∏ÄÏì∞Í∏∞ ÎßÅÌÅ¨ -->
								<a th:href="@{/community/comm_create}" class="form-control btn"><i
									class="bi bi-pencil-fill"></i> Í∏ÄÏì∞Í∏∞</a>
							</th:block>
							<th:block th:unless="${session.signedInUser != null}">
								<!-- signedInUserÍ∞Ä ÏóÜÎäî Í≤ΩÏö∞: Î°úÍ∑∏Ïù∏ ÎßÅÌÅ¨ -->
								<a th:href="@{/user/signin}" class="form-control btn">Î°úÍ∑∏Ïù∏</a>
							</th:block>
						</div>

						<a th:href="@{/community/comm_main}" class="all-post-btn px-2">
							<i class="bi bi-list"></i> Ï†ÑÏ≤¥ Í≤åÏãúÍ∏Ä
						</a>
					</div>
					<div class="comm-middle ">
						<!-- Ïù¥Ï†ÑÍ∏Ä, Îã§ÏùåÍ∏Ä, Î™©Î°ùÎ≥¥Í∏∞ Î≤ÑÌäº ÏòÅÏó≠ -->
						<div class="pre-next d-flex justify-content-end mb-3">

							<input th:value="|Ïù¥Ï†ÑÍ∏Ä Ïú†Î¨¥: ${previousPost}|" /> <input
								th:value="|Îã§ÏùåÍ∏Ä Ïú†Î¨¥: ${nextPost}|" /> <a
								th:href="@{${previousPost == null ? '#' : '/community/details/{id}(id=${previousPost.id})'}}"
								class="btn btn-outline-secondary"
								th:classappend="${previousPost == null ? 'disabled' : ''}">
								<i class="bi bi-chevron-up"></i> Ïù¥Ï†ÑÍ∏Ä
							</a> <a
								th:href="@{${nextPost == null ? '#' : '/community/details/{id}(id=${nextPost.id})'}}"
								class="btn btn-outline-secondary"
								th:classappend="${nextPost == null ? 'disabled' : ''}"> Îã§ÏùåÍ∏Ä
								<i class="bi bi-chevron-down"></i>
							</a>

						</div>
						<div class="card">
							<div class="card-header">
								<small class="card-category" th:text="*{category.name}"></small>
								<input type="hidden" id="postId" th:value="*{id}" />
								<h3 class="card-title" th:text="*{title}"></h3>
								<span><i class="bi bi-person" th:text="*{user.nickname}"></i></span></br>
								<div class="title-info mt-2">
									<i class="bi bi-clock"></i> <small class="text-black"
										th:text="*{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}"></small>
									<span><i class="bi bi-eye" th:text="*{views}"></i></span> <span><i
										class="bi bi-hand-thumbs-up" th:text="*{likes}"></i> <span
										id="likesCount"></span></span> <span><i
										class="bi bi-chat-dots" th:text="${commentcount}"></i></span>

								</div>
							</div>

							<div class="card-body">
								<div class="post-info d-flex justify-content-between mb-3">


								</div>
								<div class="post-content">
									<th:block th:ift="*{media != null}">
										<div class="image-container">
											<img alt="" th:src="@{${post.media}}"
												class="img-fluid max-size">
										</div>
									</th:block>
									<div th:text="*{content}"></div>
									<div th:text="|ÏÑ∏ÏÖò Ïú†Ï†Ä: ${session.signedInUser}|"></div>
									<div th:text="|Í≤åÏãúÍ∏Ä ÏûëÏÑ±Ïûê: ${post.user.userid}|"></div>
								</div>

								<!-- Í≤åÏãúÍ∏Ä Ï¢ãÏïÑÏöî Î≤ÑÌäº ÏòÅÏó≠(Ïù¥Í±∏ Ïôú Î°úÍ∑∏Ïù∏ ÏÑ∏ÏÖòÏóê ÎåÄÌïú Ï°∞Í±¥Î∂Ä Í±∏Ïñ¥ÎÜ®ÎäîÏßÄ Ïù¥Ìï¥Í∞Ä 1ÎèÑ Ïïà Îê®) -->
								<div class="position-relative mb-4 text-center">
									<th:block th:if="${session.signedInUser eq {post.user.userid}}">
										<!-- Î°úÍ∑∏Ïù∏Ìïú ÏÇ¨Ïö©ÏûêÍ∞Ä ÏûàÏùÑ ÎïåÏùò Î≤ÑÌäº -->
										<button id="btnLikes" class="btn btn-like btn-lg btn-custom">
											<i class="bi bi-heart-fill"></i>
										</button>
									</th:block>
									<th:block th:if="${session.signedInUser != {post.user.userid}}">
										<!-- Î°úÍ∑∏Ïù∏Ìïú ÏÇ¨Ïö©ÏûêÍ∞Ä ÏóÜÏùÑ ÎïåÏùò Ï≤òÎ¶¨ -->
										<button id="btnLikes-notloggedIn"
											class="btn btn-like btn-lg btn-custom">
											<i class="bi bi-heart-fill"></i>
										</button>
									</th:block>
								</div>

								<!-- Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú/ÏàòÏ†ïÌïòÍ∏∞ ÏòÅÏó≠ -->
								<div class="d-flex justify-content-end mt-2">
									<th:block
										th:if="${session.signedInUser == post.user.userid or session.signedInUser == 'admin'}">
										<form th:action="@{/community/comm_modify/{id}(id=*{id})}"
											method="get" style="display: inline;">
											<button type="submit"
												class="btn btn-outline-primary btn-custom ms-2">‚úèÔ∏èÏàòÏ†ï</button>
										</form>
										<button id="btnDelete"
											class="btn btn-outline-danger btn-custom ms-2">üóëÔ∏èÏÇ≠Ï†ú</button>
									</th:block>
								</div>







								<!-- ÎåìÍ∏Ä ÏûëÏÑ± ÏòÅÏó≠ -->
								<th:block th:if="${session.signedInUser != null}">
									<form class="comment-form">
										<div class="input-group mb-3">
											<div class="col-2">
												<input name="author" id="author" type="hidden"
													class="form-control" th:value="${session.signedInUser}">
											</div>
											<div class="col-8">
												<textarea name="content" id="content" class="form-control"
													rows="2" placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
											</div>
											<div class="col-2">
												<input type="hidden" name="postId" th:value="*{id}">
												<button id="btnRegisterComment"
													class="btn btn-success btn-register-comment" type="submit">Îì±Î°ù</button>
											</div>
										</div>
									</form>
								</th:block>




								<!-- Ìè¨Ïª§Ïã±Ìï† ÎåìÍ∏Ä id -->
								<input type="hidden" id="commentId" value="${commentId}" />
								<div class="comment-list">
									<th:block th:each="commentlist:${commentlist}"
										th:object="${commentlist}">
										<div class="comment" th:id="|comment-${commentlist.id}|">
											<!-- ÎåìÍ∏Ä ÏûëÏÑ±Ïûê, ÎÇ¥Ïö©ÏòÅÏó≠ -->
											<b th:text="${commentlist.user.nickname}"></b>
											<p th:text="*{content}"></p>
											<div>
												<small class="text-muted"
													th:text="*{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}"></small>
												<input type="hidden" name="commentId"
													th:value="${commentlist.id}">

												<!-- ÎåìÍ∏Ä ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº ÏòÅÏó≠ -->
												<th:block
													th:if="${commentlist.user.userid == session.signedInUser or session.signedInUser == 'admin'}">
													<button id="btnUpdateComment"
														class="btn btn-success btn-register-comment" type="submit">ÏàòÏ†ï</button>
													<input type="hidden" name="commentId"
														th:value="${commentlist.id}">
													<input type="hidden" id="userid"
														th:value="${commentlist.user.id}">
													<button id="btnDeleteComment"
														class="btn btn-success btn-register-comment" type="submit">ÏÇ≠Ï†ú</button>
												</th:block>
											</div>
										</div>
									</th:block>
								</div>
							</div>
						</div>
					</div>
					<div class="comm-right">Ïù∏Í∏∞Í∏Ä Î¶¨Ïä§Ìä∏</div>
				</div>
			</div>
		</div>
	</main>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

	<script th:src="@{/js/comm_details.js}"></script>
</body>
</html>