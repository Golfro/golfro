
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Í≤åÏãúÎ¨º ÏÉÅÏÑ∏Î≥¥Í∏∞</title>
<link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet">
<link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
    rel="stylesheet">
<link rel="stylesheet" href="/css/header.css" />
<link rel="stylesheet" href="/css/footer.css" />
<link rel="stylesheet" href="/css/comm_details.css" />

<link rel="stylesheet" type="text/css" th:href="@{/css/header.css}">
</head>


<body>
    <header th:replace="~{fragments/header :: header}"></header>

    <main>
        <div
            class="d-flex flex-column justify-content-center align-items-center p-3 mb-5">
            <div class="container-fluid" th:object=${post}>

                <div class="top-ad-banner">
                    <img th:src="@{/images/ad-3.png}" alt="Í¥ëÍ≥† Î∞∞ÎÑà">
                </div>
                <div class="comm-post">

                    <div class="comm-left p-3">
                        <span class="community_title">Ïª§ÎÆ§ÎãàÌã∞</span>
                        <div class="createBtn px-2">
                            <th:block
                                th:if="${session.signedInUser != null}">
                                <!-- signedInUserÍ∞Ä ÏûàÎäî Í≤ΩÏö∞: Í∏ÄÏì∞Í∏∞ ÎßÅÌÅ¨ -->
                                <a th:href="@{/community/comm_create}"
                                    class="form-control btn"><i
                                    class="bi bi-pencil-fill"></i> Í∏ÄÏì∞Í∏∞</a>
                            </th:block>
                            <th:block
                                th:unless="${session.signedInUser != null}">
                                <!-- signedInUserÍ∞Ä ÏóÜÎäî Í≤ΩÏö∞: Î°úÍ∑∏Ïù∏ ÎßÅÌÅ¨ -->
                                <a th:href="@{/user/signin}"
                                    class="form-control btn">Î°úÍ∑∏Ïù∏</a>
                            </th:block>
                        </div>

                        <a th:href="@{/community/comm_main}"
                            class="all-post-btn px-2"> <i
                            class="bi bi-list"> </i>Ï†ÑÏ≤¥ Í≤åÏãúÍ∏Ä
                        </a>
                        <div class="cate-post-btn px-2">Ïπ¥ÌÖåÍ≥†Î¶¨</div>
                        <a
                            th:href="@{http://localhost:8080/community/comm_main?post-cate=F001&search-category=t&keyword=}"
                            class="cate-post-btn px-2"> <i
                            class="bi bi-dot"></i> Ïû°Îã¥
                        </a><a
                            th:href="@{http://localhost:8080/community/comm_main?post-cate=F002&search-category=t&keyword=}"
                            class="cate-post-btn px-2"> <i
                            class="bi bi-dot"></i> ÌåÅ/ÎÖ∏ÌïòÏö∞
                        </a><a
                            th:href="@{http://localhost:8080/community/comm_main?post-cate=F003&search-category=t&keyword=}"
                            class="cate-post-btn px-2"> <i
                            class="bi bi-dot"></i> ÎùºÏö¥Îìú ÌõÑÍ∏∞
                        </a>
                    </div>
                    <div class="comm-middle ">
                        <!-- Ïù¥Ï†ÑÍ∏Ä, Îã§ÏùåÍ∏Ä, Î™©Î°ùÎ≥¥Í∏∞ Î≤ÑÌäº ÏòÅÏó≠ -->
                        <div
                            class="pre-next d-flex justify-content-end mb-3">
                            <a
                                th:href="${previousPost == null ? '#' : '/community/details/' + previousPost.id}"
                                class="btn btn-outline-secondary"
                                th:classappend="${previousPost == null ? 'disabled' : ''}">
                                <i class="bi bi-chevron-up"></i> Ïù¥Ï†ÑÍ∏Ä
                            </a> <a
                                th:href="${nextPost == null ? '#' : '/community/details/' + nextPost.id}"
                                class="btn btn-outline-secondary"
                                th:classappend="${nextPost == null ? 'disabled' : ''}">
                                Îã§ÏùåÍ∏Ä <i class="bi bi-chevron-down"></i>
                            </a>
                        </div>




                        <div class="card">
                            <div class="card-header">
                                <small class="card-category"
                                    th:text="*{category.name}"></small>
                                <input type="hidden" id="postId"
                                    th:value="*{id}" />
                                <h3 class="card-title"
                                    th:text="*{title}"></h3>
                                <span><i class="bi bi-person"
                                    th:text="*{user.nickname}"></i></span></br>
                                <div
                                    class="d-flex justify-content-between">
                                    <div class="title-info mt-2">
                                        <small><i
                                            class="bi bi-clock"></i></small> <small
                                            th:text="*{#temporals.format(createdTime, 'yy.MM.dd HH:mm')}"></small>
                                        <small><i
                                            class="bi bi-eye"
                                            th:text=" *{views}"></i></small> <small><i
                                            class="bi bi-hand-thumbs-up"
                                            th:text=" *{likes}"></i> <small
                                            id="likesCount"></small></small> <small><i
                                            class="bi bi-chat-dots"
                                            th:text="${commentcount}"></i></small>

                                    </div>
                                    <div
                                        class="d-flex align-items-center">
                                        <div class="url-copy-container">
                                            <span id="copyMessage"
                                                class="text-success"
                                                style="display: none;">Ï£ºÏÜåÍ∞Ä
                                                Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!</span>
                                            <button id="btnCopyUrl"
                                                class="btn btn-custom">
                                                <i class="bi bi-share"></i>
                                            </button>
                                        </div>
                                        <script>
																																									document
																																											.getElementById(
																																													'btnCopyUrl')
																																											.addEventListener(
																																													'click',
																																													function() {
																																														const currentUrl = window.location.href;
																																														navigator.clipboard
																																																.writeText(
																																																		currentUrl)
																																																.then(
																																																		function() {
																																																			const message = document
																																																					.getElementById('copyMessage');
																																																			message.style.display = 'inline';
																																																			setTimeout(
																																																					function() {
																																																						message.style.display = 'none';
																																																					},
																																																					2000);
																																																		},
																																																		function(
																																																				err) {
																																																			console
																																																					.error(
																																																							'URL Î≥µÏÇ¨ Ïã§Ìå®: ',
																																																							err);
																																																		});
																																													});
																																								</script>

                                        <!-- Dropdown button next to the share button -->
                                        <div
                                            th:if="${session.signedInUser != null}"
                                            class="dropdown ms-2">
                                            <i class="bi bi-three-dots"
                                                id="dropdownMenuButton"
                                                data-bs-toggle="dropdown"
                                                aria-expanded="false"
                                                style="cursor: pointer;"></i>
                                            <ul
                                                class="dropdown-menu dropdown-menu-end custom-dropdown-menu"
                                                aria-labelledby="dropdownMenuButton">
                                                <th:block
                                                    th:if="${session.signedInUser == post.user.userid or session.signedInUser == 'admin'}">
                                                    <form
                                                        th:action="@{/community/comm_modify/{id}(id=*{id})}"
                                                        method="get"
                                                        style="display: inline;">
                                                        <button
                                                            type="submit"
                                                            id="modifyDelete"
                                                            class="btn btn-custom ms-2">ÏàòÏ†ïÌïòÍ∏∞</button>
                                                    </form>
                                                    <button
                                                        id="btnDelete"
                                                        class="btn btn-custom ms-2">ÏÇ≠Ï†úÌïòÍ∏∞</button>
                                                </th:block>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card-body">
                                <div
                                    class="post-info d-flex justify-content-between mb-3">


                                </div>
                                <div class="post-content">
                                    <th:block th:ift="*{media != null}">
                                        <div class="image-container">
                                            <img alt=""
                                                th:src="@{${post.media}}"
                                                class="img-fluid max-size">
                                        </div>
                                    </th:block>
                                    <div th:text="*{content}"></div>
                                </div>

                                <!-- Í≤åÏãúÍ∏Ä Ï¢ãÏïÑÏöî Î≤ÑÌäº ÏòÅÏó≠(Ïù¥Í±∏ Ïôú Î°úÍ∑∏Ïù∏ ÏÑ∏ÏÖòÏóê ÎåÄÌïú Ï°∞Í±¥Î∂Ä Í±∏Ïñ¥ÎÜ®ÎäîÏßÄ Ïù¥Ìï¥Í∞Ä 1ÎèÑ Ïïà Îê®) -->

                                <div
                                    class="position-relative mb-4 text-end">
                                    <th:block
                                        th:if="${session.signedInUser != null}">
                                        <!-- Î°úÍ∑∏Ïù∏Ìïú ÏÇ¨Ïö©ÏûêÍ∞Ä ÏûàÏùÑ ÎïåÏùò Î≤ÑÌäº -->
                                        <button id="btnLikes"
                                            class="btn btn-like btn-lg btn-custom">
                                            <i
                                                class="bi bi-hand-thumbs-up-fill">
                                                Ï∂îÏ≤úÌïòÍ∏∞</i>
                                        </button>
                                    </th:block>
                                    
                                    
                                    <th:block
                                        th:if="${session.signedInUser == null}">
                                        <!-- Î°úÍ∑∏Ïù∏Ìïú ÏÇ¨Ïö©ÏûêÍ∞Ä ÏóÜÏùÑ ÎïåÏùò Ï≤òÎ¶¨ -->
                                        <button
                                            id="btnLikes-notloggedIn"
                                            class="btn btn-like btn-lg btn-custom">
                                            <i
                                                class="bi bi-hand-thumbs-up-fill">
                                                Ï∂îÏ≤úÌïòÍ∏∞</i>
                                        </button>
                                    </th:block>
                                </div>

                                <!-- Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú/ÏàòÏ†ïÌïòÍ∏∞ ÏòÅÏó≠ 
								<div class="d-flex justify-content-end mt-2">
									<th:block
										th:if="${session.signedInUser == post.user.userid or session.signedInUser == 'admin'}">
										<form th:action="@{/community/comm_modify/{id}(id=*{id})}"
											method="get" style="display: inline;">
											<button type="submit"
												class="btn btn-outline-primary btn-custom ms-2">‚úèÔ∏èÏàòÏ†ï</button>
										</form>
										<button id="btnDelete"
											class="btn btn-outline-danger btn-custom ms-2">üóëÔ∏èÏÇ≠Ï†ú</button>
									</th:block>
								</div> -->







                                <!-- ÎåìÍ∏Ä ÏûëÏÑ± ÏòÅÏó≠ -->

                                <th:block
                                    th:if="${session.signedInUser != null}">
                                    <form class="comment-form">
                                        <div class="text-left">
                                            <span><i
                                                class="bi bi-chat-dots"></i>
                                                ÎåìÍ∏Ä Î™©Î°ù</span> <span>| <span
                                                th:text="${commentcount}"></span>Í∞úÏùò
                                                ÎãµÎ≥Ä
                                            </span>
                                        </div>
                                        <div
                                            class="input-group row mt-2">
                                            <input name="author"
                                                id="author"
                                                type="hidden"
                                                class="form-control"
                                                th:value="${session.signedInUserId}">

                                            <div
                                                class="content-area justify-content-center col-12">
                                                <div
                                                    class="content-input">
                                                    <textarea
                                                        name="content"
                                                        id="content"
                                                        class="form-control"
                                                        rows="3"
                                                        placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
                                                </div>
                                                <div class="submit-btn">
                                                    <input type="hidden"
                                                        name="postId"
                                                        th:value="*{id}">
                                                    <button
                                                        id="btnRegisterComment"
                                                        class="btn btn-register-comment"
                                                        type="submit">Îì±Î°ù</button>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </th:block>




                                <!-- Ìè¨Ïª§Ïã±Ìï† ÎåìÍ∏Ä id -->
                                <input type="hidden" id="commentId"
                                    value="${commentId}" />
                                <div class="comment-list row">
                                    <th:block
                                        th:each="commentlist:${commentlist}"
                                        th:object="${commentlist}">
                                        <div class="comment col-12"
                                            th:id="|comment-${commentlist.id}|">
                                            <!-- ÎåìÍ∏Ä ÏûëÏÑ±Ïûê, ÎÇ¥Ïö©ÏòÅÏó≠ -->
                                            <b
                                                th:text="${commentlist.user.nickname}"></b>
                                            <div class="mainComment">
                                                <p th:text="*{content}"></p>
                                                <div
                                                    class="d-flex justify-content-between align-items-center">
                                                    <small
                                                        class="text-muted"
                                                        th:text="*{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}"></small>
                                                    <input type="hidden"
                                                        name="commentId"
                                                        th:value="${commentlist.id}">

                                                    <!-- ÎåìÍ∏Ä ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº ÏòÅÏó≠ -->
                                                    <div>
                                                        <th:block
                                                            th:if="${commentlist.user.userid == session.signedInUser or session.signedInUser == 'admin'}">
                                                            <button
                                                                id="btnUpdateComment"
                                                                class="btn btn-register-comment"
                                                                type="submit">ÏàòÏ†ï</button>
                                                            <input
                                                                type="hidden"
                                                                name="commentId"
                                                                th:value="${commentlist.id}">
                                                            <input
                                                                type="hidden"
                                                                id="userid"
                                                                th:value="${commentlist.user.id}">
                                                            <button
                                                                id="btnDeleteComment"
                                                                class="btn btn-register-comment"
                                                                type="submit">ÏÇ≠Ï†ú</button>
                                                        </th:block>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </th:block>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="comm-right">

                        <div class="best-posts">BEST Ïã§ÏãúÍ∞Ñ Ïù∏Í∏∞Í∏Ä</div>

                        <!-- Ï≤´ Î≤àÏß∏ ÌÖåÏù¥Î∏î (Ïû°Îã¥) -->
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <th class="text-center mt-2"
                                        colspan="3">Ïû°Îã¥</th>
                                </thead>
                                <tbody>
                                    <th:block
                                        th:each="F001 : ${top5ByF001}">
                                        <tr class="table">
                                            <td class="left-align-bold"><a
                                                th:href="@{{id}(id=${F001.id})}"
                                                class="custom-link"
                                                th:text="${F001.title}"></a></td>

                                            <td><i
                                                class="bi bi-hand-thumbs-up"
                                                th:text="| ${F001.likes}|"></i></td>
                                        </tr>
                                    </th:block>
                                </tbody>
                            </table>
                        </div>

                        <!-- Îëê Î≤àÏß∏ ÌÖåÏù¥Î∏î (ÌåÅ/ÎÖ∏ÌïòÏö∞) -->
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th class="text-center mt-2"
                                            colspan="3">ÌåÅ/ÎÖ∏ÌïòÏö∞</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <th:block
                                        th:each="F002 : ${top5ByF002}">
                                        <tr class="table">
                                            <td class="left-align-bold"><a
                                                th:href="@{{id}(id=${F002.id})}"
                                                class="custom-link"
                                                th:text="${F002.title}"></a></td>

                                            <td><i
                                                class="bi bi-hand-thumbs-up"
                                                th:text="| ${F002.likes}| + '&nbsp;&nbsp;&nbsp;'"></i></td>
                                        </tr>
                                    </th:block>
                                </tbody>
                            </table>
                        </div>





                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer th:replace="~{fragments/footer :: footer}"></footer>
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script th:src="@{/js/comm_details.js}"></script>
    <script th:src="@{/js/script.js}"></script>
</body>
</html>