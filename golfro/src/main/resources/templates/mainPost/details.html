<!DOCTYPE html>
<html xmlns:th="http://www.thymleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Golfro</title>
<link rel="stylesheet" type="text/css" th:href="@{/css/header.css}">
<link rel="stylesheet" type="text/css"
	th:href="@{/css/main_details.css}">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
	crossorigin="anonymous">

</head>
<body>
	<header th:replace="~{fragments/header :: header}"></header>
	<main>
		<div
			class="container d-flex flex-column justify-content-center align-items-center">
			<div class=" container-fluid card border-0" th:object="${post}">
				<h2>LESSON</h2>
				<h7>골프에 대해 궁금한 점들을 물어보세요.</h7>
				<input id="sessionUser" type="hidden" th:value="${session.signedInUser}" />
				<input id="postAuthor" type="hidden" th:value="${post.userid}" />
				<div class="mobile-header">
					<a href="/">LESSON > </a><span>골프에 대해 궁금한 점들을 물어보세요.</span>
				</div>

				<div class="card-header border-0 form-control container-fluid">
					<div class="category">
						<span class="cl"> 클럽종류 / </span> <span class="club"
							th:text="*{clubName}"></span>
					</div>
					<div class="mb-2">
						<span id="detailsTitle" th:text="*{title}"></span>
					</div>
					<div class="date-container mb-3">
						<p>
							<i class="bi bi-alarm"
								th:text="| 작성시간 : *{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}|"></i>
						</p>
						<p>
							<i class="bi bi-alarm-fill"
								th:text="| 수정시간 : *{#temporals.format(createdTime, 'yyyy-MM-dd HH:mm:ss')}|"></i>
						</p>
					</div>
				</div>

				<div class="mainTextArea">
					<div class="left">
						<video class="video-container" autoplay>
							<source th:src="*{mediaPath}" type="video/mp4">
						</video>
					</div>
					<div class="right form-control">
						<div
							class="nick-date d-flex justify-content-start align-items-start">
							<i
								class="bi bi-person-circle d-flex justify-content-start align-items-start"></i>
							<div class="nickname mb-2">
								<h7 th:text="*{nickname}"></h7>
								<div>
									<span
										th:text="*{height == null ? '키: 데이터 없음' : '키: ' + height + 'cm /'}"></span>
									<span
										th:text="*{career == null ? '구력: 데이터 없음' : '구력: ' + career + '년 /'}"></span>
									<span
										th:text="*{handy == null ? '헨디: 데이터 없음' : '헨디: ' + handy + ' /'}"></span>
									<span
										th:text="*{ironDistance == null ? '아이언 평균 거리: 데이터 없음' : '아이언 평균 거리: ' + ironDistance + 'm /'}"></span>
									<span
										th:text="*{driverDistance == null ? '드라이버 평균 거리: 데이터 없음' : '드라이버 평균 거리: ' + driverDistance + 'm'}"></span>
								</div>
							</div>
						</div>

						<div class="post">
							<div class="post-sticky mb-2">
								<div class="post-content">
									<p th:text="*{content}"></p>
								</div>
								<!-- 포커싱할 댓글 id -->
								<input type="hidden" id="commentId" th:value="${commentId}" />
							</div>

							<!-- 댓글 리스트 영역 -->
							<div class="comments-section form-control">
								<div class="form-group">
									<input class="form-control mt-2" type="hidden" id="signedInUser" required th:value="${session.signedInUser}" />
									<input type="hidden" id="postId" th:value="*{id}"/>
								</div>
							</div>
							
							
						</div>
						<div class="last-section">
							<div
								class="sub d-flex justify-content-between align-items-center">
								
								<!-- 조회수, 추천하기 영역 -->
								<div class="views-likes-container d-flex align-items-center">
									<span th:text="|게시글 조회수 : *{views}|"><i
										class="bi bi-eye"></i> </span>
									<button id="likes" class="likes bi bi-hand-thumbs-up">추천하기버튼</button>
									<p id="likesCounts" th:text="|게시글 추천수 : *{likes}|"></p>
								</div>
								
								
								
								<!-- 하단 수정하기, 삭제 버튼 영역 -->
								<div class="dropdown">
									<button class="btn dropdown-toggle" type="button"
										id="dropdownMenuButton" data-bs-toggle="dropdown"
										aria-expanded="false">
										<i class="bi bi-three-dots"></i>
									</button>
									<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
										<!-- 조건: 세션의 signedInUser와 post.author가 같거나 signedInUser가 'admin'인 경우 -->
										<li
											th:if="${session.signedInUser eq post.userid or session.signedInUser eq 'admin'}">
											<button class="dropdown-item btnModifyid">수정하기</button>
										</li>
										<li
											th:if="${session.signedInUser eq post.userid or session.signedInUser eq 'admin'}">
											<button class="dropdown-item btnDeleteMainPost">삭제하기</button>
										</li>
									</ul>
								</div>
								
								
								
							</div>

							<div>
								<!-- 전문가 승인이 완료된 회원의 경우 -->
								<div th:if="${session.signedInUserGrade.id == 'G10'}">
									<textarea class="form-control" id="content" name="ctext"
										rows="3" required placeholder="피드백을 작성해주세요."></textarea>
								</div>

								<!-- 전문가 승인이 완료되지 않은 회원의 경우 -->
								<div th:unless="${session.signedInUserGrade.id == 'G10'}">
									<textarea class="form-control" id="finishContent"
										readonly="readonly">전문가 승인이 완료된 회원만 작성 할 수 있습니다.</textarea>
								</div>
							</div>

							<!-- 전문가 승인이 완료된 회원만 버튼이 노출 -->
							<div th:if="${session.signedInUserGrade.id == 'G10'}">
								<button id="btnRegisterComment" class="btn form-control">피드백
									작성하기</button>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<!-- 부트스트랩 -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
		crossorigin="anonymous"></script>

	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script th:src="@{/js/commentsSub.js}"></script>
	<script th:src="@{/js/commentsJS.js}"></script>
</body>
</html>